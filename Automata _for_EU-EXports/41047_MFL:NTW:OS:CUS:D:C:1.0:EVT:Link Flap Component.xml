<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<automatonExport>
    <automaton>
        <approvalNotes>Date: 17Jan2017 - Version 1.0&#xD;
Devops:https://hub.jazz.net/ccm06/resource/itemName/com.ibm.team.workitem.WorkItem/35696</approvalNotes>
        <approvalStatus>APPROVED</approvalStatus>
        <automaticDelaySeconds>60</automaticDelaySeconds>
        <created>2016-11-14T06:34:56Z</created>
        <Category>
            <categoryID>1299</categoryID>
            <clientID>48</clientID>
            <name>Diagnosis</name>
            <parent>
                <categoryID>1297</categoryID>
                <clientID>48</clientID>
                <name>Components</name>
                <parent>
                    <categoryID>802</categoryID>
                    <clientID>48</clientID>
                    <name>Network Management</name>
                </parent>
            </parent>
        </Category>
        <automatonID>41047</automatonID>
        <executionMode>MANUAL</executionMode>
        <isLive>true</isLive>
        <isMasterTicketOnly>true</isMasterTicketOnly>
        <matchType>AND</matchType>
        <modified>2017-01-19T12:35:41Z</modified>
        <name>MFL:NTW:OS:CUS:D:C:1.0:EVT:Link Flap Component</name>
        <purpose>DIAGNOSIS</purpose>
        <newExecutionThrottleCount>0</newExecutionThrottleCount>
        <newExecutionThrottlePeriodSeconds>0</newExecutionThrottlePeriodSeconds>
        <engineerTimeToDiagnose>0</engineerTimeToDiagnose>
        <engineerTimeToRemediate>0</engineerTimeToRemediate>
        <ConstantVariables>
            <ConstantVariable>
                <automatonID>41047</automatonID>
                <name>bgp_status</name>
                <secure>false</secure>
                <variableID>468911</variableID>
                <value>&lt;![CDATA[OK]]&gt;</value>
            </ConstantVariable>
            <ConstantVariable>
                <automatonID>41047</automatonID>
                <name>outcome</name>
                <secure>false</secure>
                <variableID>468912</variableID>
                <value>&lt;![CDATA[OK]]&gt;</value>
            </ConstantVariable>
            <ConstantVariable>
                <automatonID>41047</automatonID>
                <name>component_output</name>
                <secure>false</secure>
                <variableID>468906</variableID>
                <value>&lt;![CDATA[tbd]]&gt;</value>
            </ConstantVariable>
            <ConstantVariable>
                <automatonID>41047</automatonID>
                <name>args</name>
                <secure>false</secure>
                <variableID>468905</variableID>
                <value>&lt;![CDATA[{}]]&gt;</value>
            </ConstantVariable>
            <ConstantVariable>
                <automatonID>41047</automatonID>
                <name>sum_status</name>
                <secure>false</secure>
                <variableID>468913</variableID>
                <value>&lt;![CDATA[OK]]&gt;</value>
            </ConstantVariable>
        </ConstantVariables>
        <FormVariables/>
        <RegexExtractVariables>
            <RegexExtractVariable>
                <automatonID>41047</automatonID>
                <defaultValue>  </defaultValue>
                <name>bgp_down</name>
                <secure>false</secure>
                <variableID>468909</variableID>
                <actionID>623786</actionID>
                <field>OUT</field>
                <filterPattern>^\d+.*</filterPattern>
                <matchPattern>.*(down|idle).*</matchPattern>
                <replacePattern>$1</replacePattern>
            </RegexExtractVariable>
            <RegexExtractVariable>
                <automatonID>41047</automatonID>
                <name>sum_out</name>
                <secure>false</secure>
                <variableID>468908</variableID>
                <actionID>623785</actionID>
                <field>OUT</field>
            </RegexExtractVariable>
            <RegexExtractVariable>
                <automatonID>41047</automatonID>
                <name>int_out</name>
                <secure>false</secure>
                <variableID>468910</variableID>
                <actionID>623786</actionID>
                <field>OUT</field>
            </RegexExtractVariable>
            <RegexExtractVariable>
                <automatonID>41047</automatonID>
                <defaultValue>  </defaultValue>
                <name>bgp_out</name>
                <secure>false</secure>
                <variableID>468907</variableID>
                <actionID>623785</actionID>
                <field>OUT</field>
                <filterPattern>.*down.*</filterPattern>
                <matchPattern>(?i).*(deleted.*down)|(.*down)</matchPattern>
                <replacePattern>$2</replacePattern>
            </RegexExtractVariable>
        </RegexExtractVariables>
        <RuntimeVariables/>
        <ScriptExtractVariables/>
        <Connections>
            <Connection>
                <name>affected_host</name>
                <connectionClientCode>mfl</connectionClientCode>
                <connectionProtocol>SSH</connectionProtocol>
                <connectionHost>198.18.125.46</connectionHost>
            </Connection>
        </Connections>
        <CMDBAssociateActions/>
        <CMDBQueryActions/>
        <EditVariableActions>
            <EditVariableAction>
                <actionID>623784</actionID>
                <RegexExtractVariableIDs/>
                <ScriptExtractVariableIDs/>
                <stateID>749546</stateID>
                <refresh>false</refresh>
                <script>var component_output="Please find the details below:\n";
component_output+="======================\n\n";
component_output+=int_out + "\n\n" + sum_out;
component_output;</script>
                <EditVariableTransforms/>
                <variableID>468906</variableID>
            </EditVariableAction>
            <EditVariableAction>
                <actionID>623783</actionID>
                <RegexExtractVariableIDs/>
                <ScriptExtractVariableIDs/>
                <stateID>749547</stateID>
                <refresh>false</refresh>
                <script>if(typeof JSON!=="object"){JSON={}}(function(){"use strict";function f(e){return e&lt;10?"0"+e:e}function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];if(a&amp;&amp;typeof a==="object"&amp;&amp;typeof a.toJSON==="function"){a=a.toJSON(e)}if(typeof rep==="function"){a=rep.call(t,e,a)}switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a){return"null"}gap+=indent;u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n&lt;s;n+=1){u[n]=str(n,a)||"null"}i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]";gap=o;return i}if(rep&amp;&amp;typeof rep==="object"){s=rep.length;for(n=0;n&lt;s;n+=1){if(typeof rep[n]==="string"){r=rep[n];i=str(r,a);if(i){u.push(quote(r)+(gap?": ":":")+i)}}}}else{for(r in a){if(Object.prototype.hasOwnProperty.call(a,r)){i=str(r,a);if(i){u.push(quote(r)+(gap?": ":":")+i)}}}}i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}";gap=o;return i}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var cx,escapable,gap,indent,meta,rep;if(typeof JSON.stringify!=="function"){escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;meta={"\b":"\\b","  ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};JSON.stringify=function(e,t,n){var r;gap="";indent="";if(typeof n==="number"){for(r=0;r&lt;n;r+=1){indent+=" "}}else if(typeof n==="string"){indent=n}rep=t;if(t&amp;&amp;typeof t!=="function"&amp;&amp;(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":e})}}if(typeof JSON.parse!=="function"){cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&amp;&amp;typeof i==="object"){for(n in i){if(Object.prototype.hasOwnProperty.call(i,n)){r=walk(i,n);if(r!==undefined){i[n]=r}else{delete i[n]}}}}return reviver.call(e,t,i)}var j;text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})()

//convert string to JSON object(hash)
args=JSON.parse(args);
args["closure_code"]="Diagnosis";
args=JSON.stringify(args);</script>
                <EditVariableTransforms/>
                <variableID>468905</variableID>
            </EditVariableAction>
        </EditVariableActions>
        <EmailActions>
            <EmailAction>
                <actionID>623788</actionID>
                <RegexExtractVariableIDs/>
                <ScriptExtractVariableIDs/>
                <stateID>749541</stateID>
                <body>${component_output}
${outcome}
${bgp_status}
${sum_status}
${args}</body>
                <from>@</from>
                <subject>@</subject>
                <to>@</to>
            </EmailAction>
        </EmailActions>
        <FormActions/>
        <HostCommandActions>
            <HostCommandAction>
                <actionID>623786</actionID>
                <RegexExtractVariableIDs>
                    <RegexExtractVariableID>468909</RegexExtractVariableID>
                    <RegexExtractVariableID>468910</RegexExtractVariableID>
                </RegexExtractVariableIDs>
                <ScriptExtractVariableIDs/>
                <stateID>749544</stateID>
                <command>sh ip int brief</command>
                <connectionName>affected_host</connectionName>
                <hardTimeoutSeconds>60</hardTimeoutSeconds>
                <resetPrompt>false</resetPrompt>
                <secureStderr>false</secureStderr>
                <secureStdout>false</secureStdout>
                <timeoutSeconds>15</timeoutSeconds>
                <trim>true</trim>
            </HostCommandAction>
            <HostCommandAction>
                <actionID>623785</actionID>
                <RegexExtractVariableIDs>
                    <RegexExtractVariableID>468907</RegexExtractVariableID>
                    <RegexExtractVariableID>468908</RegexExtractVariableID>
                </RegexExtractVariableIDs>
                <ScriptExtractVariableIDs/>
                <stateID>749545</stateID>
                <command>sh ip bgp summary</command>
                <connectionName>affected_host</connectionName>
                <hardTimeoutSeconds>60</hardTimeoutSeconds>
                <resetPrompt>false</resetPrompt>
                <secureStderr>false</secureStderr>
                <secureStdout>false</secureStdout>
                <timeoutSeconds>15</timeoutSeconds>
                <trim>true</trim>
            </HostCommandAction>
            <HostCommandAction>
                <actionID>623787</actionID>
                <RegexExtractVariableIDs/>
                <ScriptExtractVariableIDs/>
                <stateID>749543</stateID>
                <command>terminal length 0</command>
                <connectionName>affected_host</connectionName>
                <hardTimeoutSeconds>60</hardTimeoutSeconds>
                <resetPrompt>false</resetPrompt>
                <secureStderr>false</secureStderr>
                <secureStdout>false</secureStdout>
                <timeoutSeconds>15</timeoutSeconds>
                <trim>true</trim>
            </HostCommandAction>
        </HostCommandActions>
        <LinkActions/>
        <LockTicketActions/>
        <RfcActions/>
        <ScriptActions/>
        <WaitForRecoveryIPmonActions/>
        <GenericTicketEventWaitActions/>
        <AckProblemIPmonActions/>
        <CancelDowntimeIPmonActions/>
        <ExecuteCheckIPmonActions/>
        <ScheduleDowntimeIPmonActions/>
        <PhoneCallActions/>
        <TimedWaitActions/>
        <UpdateTicketActions/>
        <SubmitPassiveIPmonActionDetails/>
        <HttpRequestActions/>
        <IPdiscoverActions/>
        <ExecuteIPadminActions/>
        <SQLCommandActions/>
        <NotifyActions/>
        <ForkStates/>
        <FormStates/>
        <JoinStates/>
        <LinkStates/>
        <NoopStates>
            <NoopState>
                <name>Start</name>
                <originalID>263374</originalID>
                <stateID>749542</stateID>
                <XPos>286</XPos>
                <YPos>79</YPos>
            </NoopState>
        </NoopStates>
        <NormalStates>
            <NormalState>
                <actionID>623786</actionID>
                <name>sh ip int brief</name>
                <originalID>686095</originalID>
                <stateID>749544</stateID>
                <XPos>286</XPos>
                <YPos>291</YPos>
            </NormalState>
            <NormalState>
                <actionID>623788</actionID>
                <name>Declare Vars</name>
                <originalID>263375</originalID>
                <stateID>749541</stateID>
                <XPos>416</XPos>
                <YPos>80</YPos>
            </NormalState>
            <NormalState>
                <actionID>623784</actionID>
                <name>set component_output</name>
                <originalID>686107</originalID>
                <stateID>749546</stateID>
                <XPos>500</XPos>
                <YPos>400</YPos>
            </NormalState>
            <NormalState>
                <actionID>623785</actionID>
                <name>sh ip bgp summary</name>
                <originalID>686100</originalID>
                <stateID>749545</stateID>
                <XPos>287</XPos>
                <YPos>399</YPos>
            </NormalState>
            <NormalState>
                <actionID>623783</actionID>
                <name>diagnosis closure code</name>
                <originalID>686218</originalID>
                <stateID>749547</stateID>
                <XPos>499</XPos>
                <YPos>291</YPos>
            </NormalState>
            <NormalState>
                <actionID>623787</actionID>
                <name>term len 0</name>
                <originalID>263373</originalID>
                <stateID>749543</stateID>
                <XPos>286</XPos>
                <YPos>191</YPos>
            </NormalState>
        </NormalStates>
        <SuccessStates>
            <SuccessState>
                <name>Success</name>
                <originalID>686105</originalID>
                <stateID>749548</stateID>
                <XPos>671</XPos>
                <YPos>291</YPos>
            </SuccessState>
        </SuccessStates>
        <WaitStates/>
        <Transitions>
            <Transition>
                <transitionEvaluator>
                    <completeMatch>true</completeMatch>
                    <evaluatorType>ALWAYS</evaluatorType>
                    <negate>true</negate>
                    <outputField>RET</outputField>
                    <weight>1</weight>
                </transitionEvaluator>
                <connectorLayout>309,79:319,79:325,79:325,80:384,80:394,80</connectorLayout>
                <fromStateID>749542</fromStateID>
                <labelLayout>0:0:3:50</labelLayout>
                <name>never</name>
                <toStateID>749541</toStateID>
                <transitionID>842733</transitionID>
            </Transition>
            <Transition>
                <transitionEvaluator>
                    <completeMatch>true</completeMatch>
                    <evaluatorType>ALWAYS</evaluatorType>
                    <negate>false</negate>
                    <outputField>RET</outputField>
                    <weight>1</weight>
                </transitionEvaluator>
                <connectorLayout>286,95:286,105:286,105:286,105:286,165:286,175</connectorLayout>
                <fromStateID>749542</fromStateID>
                <labelLayout>0:0:3:50</labelLayout>
                <name>go</name>
                <toStateID>749543</toStateID>
                <transitionID>842732</transitionID>
            </Transition>
            <Transition>
                <transitionEvaluator>
                    <completeMatch>false</completeMatch>
                    <evaluatorType>OUTPUT</evaluatorType>
                    <expression>.*(\Q#\E|\Q&gt;\E|\Q$\E)</expression>
                    <negate>false</negate>
                    <outputField>OUT</outputField>
                    <weight>1</weight>
                </transitionEvaluator>
                <connectorLayout>286,207:286,217:286,217:286,217:286,266:286,276</connectorLayout>
                <fromStateID>749543</fromStateID>
                <labelLayout>0:0:3:50</labelLayout>
                <name>ok</name>
                <toStateID>749544</toStateID>
                <transitionID>842731</transitionID>
            </Transition>
            <Transition>
                <transitionEvaluator>
                    <completeMatch>true</completeMatch>
                    <evaluatorType>OUTPUT</evaluatorType>
                    <expression>0</expression>
                    <negate>false</negate>
                    <outputField>RET</outputField>
                    <weight>1</weight>
                </transitionEvaluator>
                <connectorLayout>500,385:500,375:500,375:500,375:500,316:500,306</connectorLayout>
                <fromStateID>749546</fromStateID>
                <labelLayout>4:0:3:32</labelLayout>
                <name>ok</name>
                <toStateID>749547</toStateID>
                <transitionID>842728</transitionID>
            </Transition>
            <Transition>
                <transitionEvaluator>
                    <completeMatch>true</completeMatch>
                    <evaluatorType>OUTPUT</evaluatorType>
                    <expression>0</expression>
                    <negate>false</negate>
                    <outputField>RET</outputField>
                    <weight>1</weight>
                </transitionEvaluator>
                <connectorLayout>521,291:531,291:531,290:531,290:639,290:649,290</connectorLayout>
                <fromStateID>749547</fromStateID>
                <labelLayout>0:0:3:50</labelLayout>
                <name>ok</name>
                <toStateID>749548</toStateID>
                <transitionID>842727</transitionID>
            </Transition>
            <Transition>
                <transitionEvaluator>
                    <completeMatch>false</completeMatch>
                    <evaluatorType>OUTPUT</evaluatorType>
                    <expression>.*(\Q#\E|\Q&gt;\E|\Q$\E)</expression>
                    <negate>false</negate>
                    <outputField>OUT</outputField>
                    <weight>1</weight>
                </transitionEvaluator>
                <connectorLayout>310,399:320,399:320,399:320,399:469,399:479,399</connectorLayout>
                <fromStateID>749545</fromStateID>
                <labelLayout>0:0:3:50</labelLayout>
                <name>ok</name>
                <toStateID>749546</toStateID>
                <transitionID>842729</transitionID>
            </Transition>
            <Transition>
                <transitionEvaluator>
                    <completeMatch>false</completeMatch>
                    <evaluatorType>OUTPUT</evaluatorType>
                    <expression>.*(\Q#\E|\Q&gt;\E|\Q$\E)</expression>
                    <negate>false</negate>
                    <outputField>OUT</outputField>
                    <weight>1</weight>
                </transitionEvaluator>
                <connectorLayout>286,307:286,317:287,317:287,317:287,373:287,383</connectorLayout>
                <fromStateID>749544</fromStateID>
                <labelLayout>0:0:3:50</labelLayout>
                <name>ok</name>
                <toStateID>749545</toStateID>
                <transitionID>842730</transitionID>
            </Transition>
        </Transitions>
        <TicketMatchers/>
        <Tags/>
    </automaton>
    <timeOfExport>2017-06-28T07:39:12.323Z</timeOfExport>
</automatonExport>
